$(function() {
    var a = $("#GetTicketsForm").attr("action");
    var b = $("#ticketTable").DataTable({
        serverSide: true,
        processing: false,
        columns: [{
            data: "id",
            name: "id"
        }, {
            data: "email",
            name: "email",
            bSearchable: false
        }, {
            data: "amount",
            name: "amount",
            bSearchable: false
        }, {
            data: "created_at",
            name: "created_at",
            bSearchable: false
        }, {
            data: "action",
            name: "action",
            bSearchable: false
        }],
        language: {
            url: langUrl
        },
        order: [
            [0, "desc"]
        ],
        ajax: {
            type: "POST",
            url: a,
            headers: {
                "X-CSRF-TOKEN": $('meta[name="csrf-token"]').attr("content")
            }
        },
        drawCallback: function() {
            var d = this.api();
            var c = d.column(2).data().sum();
            $(d.column(2).footer()).html(Number(c))
        }
    })
});
setInterval(function() {
    $("#ticketTable").dataTable().fnDraw(false)
}, 10000);

function OnclickPrintTicket(a) {
    $(".TicketPin").modal("toggle");
    $("#userIDHiddenTicketInput").val(a);
    $("#ticketCodeInput").val("")
}
$(document).ready(function() {
    $("#SetTicket").click(function() {
        submitCodeTicket()
    })
});

function submitCodeTicket() {
    var b = $("#submitCodeTicketForm").attr("action");
    var c = $("#ticketCodeInput").val();
    var a = $("#userIDHiddenTicketInput").val();
    var d = {
        code: c,
        userID: a
    };
    $.ajax({
        type: "POST",
        data: d,
        url: b,
        headers: {
            "X-CSRF-TOKEN": $('meta[name="csrf-token"]').attr("content")
        },
        success: function(e) {
            if (e.status == "success") {
                alertify.success(msg02);
                $("#ticketTable").dataTable().fnDraw(false);
                $(".TicketPin").modal("hide")
            } else {
                alertify.error(e.msg)
            }
        }
    })
}
$("#ticketCodeInput").keypress(function(a) {
    if (a.which == 13) {
        submitCodeTicket()
    }
});
$(document).ready(function() {
    var a = $("#ticketTransactions").DataTable({
        language: {
            url: langUrl
        }
    })
});